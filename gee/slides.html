
<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Google Earth Engine basics </title>
    <meta charset="utf-8" />
    <meta name="author" content="Rob Marty, Leonardo Viotti" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/xaringanExtra-webcam/webcam.js"></script>
    <script id="xaringanExtra-webcam-options" type="application/json">{"width":"200","height":"200","margin":"1em"}</script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <link href="libs/font-awesome/css/all.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/v4-shims.css" rel="stylesheet" />
    <link rel="stylesheet" href="libs/remark-css/default.css" type="text/css" />
    <link rel="stylesheet" href="libs/remark-css/metropolis.css" type="text/css" />
    <link rel="stylesheet" href="libs/remark-css/metropolis-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Google Earth Engine basics
## ieConnect GIS Training
### Rob Marty, Leonardo Viotti
<!-- ### The World Bank | <a href="https://github.com/worldbank">WB Github</a> <br> April 2021 -->

---

&lt;style type="text/css"&gt;
@media print {
  .has-continuation {
    display: block !important;
  }
}

&lt;/style&gt;


# Table of contents

1. [Introduction to Google Earth Engine](#introduction)
2. [Initial setup](#setup)
3. [GIS and Remote sensing basics](#rs-basics)
4. [Code Editor and APIs](#code-editor)
5. [Loading data](#data)
6. [JavaScript and basic operations](#js)
7. [Mapping and Visualization](#vis)
8. [Data processing](#data-processing)
9. [Export data](#export)
10. [References and useful resources](#references)
<!-- 11. [Appendix](#appendix) -->

---

class: inverse, center, middle
name: introduction

# Introduction to Google Earth Engine

---
# Introduction to Google Earth Engine

**What?** 

- GIS platform to access, process and analyse raster data. 
- Google giving us amazing stuff for free.


**Why?** 

- Easy access to data 
- Powerful cloud resources for free

**How?** 

- It's the rest of the slides

**This session objectives**
 - Overview of main concepts and resources.
 - Cover typical workflow to use satellite/raster data for an IE, extract structured data (tabular) for a set of regions, e.g. countries or agricultural plots.
 
---

class: inverse, center, middle
name: setup

# Initial setup

---
# Initial setup: 

Course requirements:
- Basic understanding of GIS concepts (we will review briefly).
- Basic programming knowledge.

Requirements:
 - Google account
 - Google Drive free account

Set-up:

- Go to this [URL](https://developers.google.com/earth-engine/cloud/earthengine_cloud_project_setup)
- Apply in advance!
- No need to create a cloud project <font style="color:red"> I think</font>
---

class: inverse, center, middle
name: rs-basics

# GIS and Remote sensing basics


---

# GIS basics

There are two main types of spatial data: vector and raster data.

- <p style="border:2px; border-style:solid; border-color:#FFFFFF;">
  <b>Raster</b>: spatially-referenced grids where each cell has one value.</p>

- **Vectors**: spatial-referenced objects consisting of points, lines and polygons. These shapes are attached to an attributes table (a dataframe) , where each row corresponds to a different spatial element.

.pull-left[
&lt;img src="img/raster.PNG" width="400px" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="img/shapefile.PNG" width="300px" style="display: block; margin: auto;" /&gt;
]

---

# GIS basics
<!-- Duplicated to add effect -->

There are two main types of spatial data: vector and raster data.

- <p style="border:2px; border-style:solid; border-color:#FF0000;">
  <b>Raster</b>: spatially-referenced grids where each cell has one value.</p>
- **Vectors**: spatial-referenced objects consisting of points, lines and polygons. These shapes are attached to an attributes table (a dataframe) , where each row corresponds to a different spatial element.

.pull-left[
&lt;img src="img/raster.PNG" width="400px" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="img/shapefile.PNG" width="300px" style="display: block; margin: auto;" /&gt;
]

---
# GIS basics: Coordinate reference systems

**Coordinate reference systems (CRS)** map pairs of numbers to a location.

.pull-left-long[
 - **Geographic Coordinate Systems** live on a sphere; here, the units are in decimal degrees (latitude = angle from equator; longitude = angle from prime meridian)
    - Using the WGS84 coordinate system the World Bank MC building is located at 38.89 degrees latitude and -77.04 degrees longitude.
 ]
.pull-right-short[&lt;img src="img/coordinate_systems_geo.jpg" width="100px" style="display: block; margin: auto;" /&gt;
]

.pull-left-long[
- **Projected Coordinate Systems** project the earth onto a flat surface (units here are typically in meters from some reference point).
    - Using to the World Mercator projection, the World Bank headquarters (MC building) is located 4680364.64 meters north and -8576320.73 meters east.
]
.pull-right-short[&lt;img src="img/coordinate_systems_projected.jpg" width="100px" style="display: block; margin: auto;" /&gt;
]

---
# GIS basics: [Projections](https://xkcd.com/977/)


Projecting the earth onto a flat surface distorts [distorts](http://geoawesomeness.com/5-tools-will-let-master-map-projections/) the earth in some way (shape, area, distance or direction). 

.center[
&lt;img src="img/projection_unravel.png"  width = 620 / &gt;]

---
# Remote sensing: basics

<br><br><br>

.blockquote[
Remote sensing is the acquisition of information about an object or phenomenon without making physical contact with the object, in contrast to in situ or on-site observation.
]

- But generally we mean satellites!
- satellites can be passive or active

<font style="color:red"> Image here</font>

- In this course we wil mostly focus on passive satellites for simplicity.

.footnote[
https://en.wikipedia.org/wiki/Remote_sensing
]
---
# Remote sensing: Light

[Light](https://www.youtube.com/watch?v=jjy-eqWM38g) is electromagnetic radiation and we only see a small fraction of it.

<br><br>

&lt;img src="img/wavelenght-chartpng.png" width="900px" style="display: block; margin: auto;" /&gt;


---
# Remote sensing: Raster Bands

Staellites or remote sensing instruments can see much more!

.pull-left[
- Generally multiple light spectrums can be accessed in a single product in the form of multiple [raster bands](https://www.neonscience.org/resources/learning-hub/tutorials/dc-multiband-rasters-r).

- In practice each band is a separate image, but they can be combined to form more complex images. For example, color images are composites of red, blue and green bands (RBG).

]

.pull-right[
&lt;img src="img/landsat_bands.gif" width="900px" style="display: block; margin: auto;" /&gt;
]

<br>

Since raster is just a data format, some products may use bands for storing other types of data as well (e.g. [deforestation](https://developers.google.com/earth-engine/tutorials/tutorial_forest_02)). You can think of bands as variables in a 2D dataset.


---
# Remote sensing: [NDVI](https://en.wikipedia.org/wiki/Normalized_difference_vegetation_index) example

Normalized difference vegetation index (NDVI) is proxy of vegetation in an image. 
- It measures the difference between near-infrared (which vegetation strongly reflects) and red light (which vegetation absorbs).
- It ranges from -1 to 1
- Applications range from tracking deforestation to crop health in precision agriculture.

<p>

  \[
  NDVI = {(NIR - Red) \over (NIR  + Red)}
  
  \]
</p>

<p style="color:red"> Add images example here</p>

<!-- [RM] For light physics stuff, could include how NDVI is made, then just list
out a bunch of other indices that can be created (beyond course to go in depth
for other indices, but good to show NDVI because so popular then good to know
that others exist)
https://custom-scripts.sentinel-hub.com/ -->


---

# Remote sensing: Resolution

On top of we can have two more dimetions to raster data:

 - **Spatial resolution**: How large each pixel in the image is.
 &lt;img src="img/raster_multiple_resolutions.png" width="600px" alt="https://www.neonscience.org/resources/learning-hub/tutorials/raster-res-extent-pixels-r" style="display: block; margin: auto;" /&gt;

<br>
 - **Temporal resolution**: How often do we have images for a each location (revisit time).
 &lt;img src="img/raster_temporal_resolutions.png" width="700px" alt="https://openeo.org/documentation/1.0/datacubes.html" style="display: block; margin: auto;" /&gt;

---
 # Remote sensing: Resolution (2)

 
 - ** [Spectral resolution](https://gisgeography.com/spatial-resolution-vs-spectral-resolution/) ** - Spectral resolution describes the amount of spectral detail in a band. For example, a multispectral image breaks light into 4 to 36 bands. Then, it assigns those bands names such as red, green, blue, and near-infrared. Each band may span 0.05 um in the electromagnetic spectrum.
 
- **[Radiometric resolution](https://www.nrcan.gc.ca/maps-tools-and-publications/satellite-imagery-and-air-photos/tutorial-fundamentals-remote-sensing/satellites-and-sensors/radiometric-resolution/9379)**  - The radiometric resolution of an imaging system describes its ability to discriminate very slight differences in energy The finer the radiometric resolution of a sensor, the more sensitive it is to detecting small differences in reflected or emitted energy.

- **[Sawth resolution](https://www.nrcan.gc.ca/maps-tools-and-publications/satellite-imagery-and-air-photos/tutorial-fundamentals-remote-sensing/satellites-and-sensors/satellite-characteristics-orbits-and-swaths/9283)**  - As a satellite revolves around the Earth, the sensor "sees" a certain portion of the Earth's surface. The area imaged on the surface, is referred to as the swath. Imaging swaths for spaceborne sensors generally vary between tens and hundreds of kilometres wide.


 
---
# Remonte sensing: Data processing levels

**Level 0**: Raw data as measured at the sensor (radiance values). Not directly interpretable 

**Level 1**: Radiometric and geometric corrections
  - Data is interpretable - reflectance or brightness values
  - Top-of-Atmosphere product (TOA)

**Level 2**: Atmospheric corrections
 - Surfice reflectance or temperature

**Level 3**: Data is mapped on uniform space-time grid scales <span style = "color: #FF0000;"> Example?s</span>

**Level 4**: 	Model output or results from analyses of lower-level data (e.g., variables derived from multiple measurements).

.footnote[
  https://earthdata.nasa.gov/collaborate/open-data-services-and-software/data-information-policy/data-levels
  
  https://www.youtube.com/watch?v=xAyNu9HbK8s

]

<!-- ---

# Remote sensing: Data examples

GEE has an extensive data catalog. Below we can find a couple of examples

 DAYTIME IMAGERY:

 | Source      | Resolution | Time Period | Capture imagery every... | N bands |
 | ----------- | ---------- | ----------- | ------------------------ | ------- |
 | Landsat     | 30m         | 1970s-     | 2 (ish) weeks             | 8ish?   |
 | Sentinel    | 10m         | 2015/7?-   | 2 (ish) weeks           | 8ish?   |
 | MODIS       | 500m         | 2000-     | Daily      | XX |
 
 See resolution vs. capture frequency trade off (MODIS vs landsat/sentinel)
 
 NIGHTTIME Imagery:
 
 | Source      | Resolution | Time Period | Capture imagery every... |
 | ----------- | ---------- | ----------- | ------------------------ |
 | DMSP-OLS    | 1km        | 1992-2013   | Annual             |
 | VIIRS       | 750m       | 2012-       | Monthly            |
 
 Or I think both capture daily, but annual / monthly is what GEE provides -->

---
class: inverse, center, middle
name: code-editor

# Code Editor and APIs

---

# Code Editor and APIs

There 3 different ways to use Google Earth Engine:
 - [JavaScript API](https://developers.google.com/earth-engine/tutorials/tutorial_api_01)
 - [R API](https://github.com/r-spatial/rgee)
 - [Python API](https://developers.google.com/earth-engine/guides/python_install)

We will focus on the JavaScript tool that provides a web based environment for the API.
 - Easier to set-up.
 - More resources available.
 - Several built-in tools that are particularly useful for beginners.

---
# Code Editor

&lt;img src="img/Code_editor_diagram.png" width="900px" style="display: block; margin: auto;" /&gt;

.footnote[
https://developers.google.com/earth-engine/guides/playground
]


---

class: inverse, center, middle
name: data-types
 
# Data types
 
---
 
# Data types

GEE has 2 main data types:

- An `Image` is composed of one or more bands and each band has its own name, data type, scale, mask and projection. Images can also have metadata stored as a set of properties.

- A `Feature` is a GeoJSON object. Specifically, a Feature is an object with a geometry property storing a Geometry object (or null) and a properties property storing a dictionary of other properties.

These objects can also be stacked to store more complex data: 

 - `ImageCollection` a stack or sequence of images, e.g. multiple days of image for a same location.
 - `FeatureCollection` a group of related features, e.g. vector data with multiple geometries. It also used to store tabular data since GEE has no native structured data.



 .footnote[Source: https://developers.google.com/earth-engine/guides/]
---

class: inverse, center, middle
name: data

# Loading data

---

# Loading data

 - Data catalog
 - Uploading your own data

---

class: inverse, center, middle
name: js

# JavaScript and basic operations

---

# JavaScript and basic operations

 - JS syntax
 - Defining variables and functions
 - Debugging (printing objects and metadata)

 - Syntax particularities (e.g. no named arguments?)


---
class: inverse, center, middle
name: vis

# Mapping and Visualization

---

# Mapping and Visualization

GEE offers a quick visualization tool very useful for data exploration and troubleshooting.

- Plot images
- Plot geometries
- Inspection tool

---
class: inverse, center, middle
name: data-processing

# Data processing

---

# Data processing

Core concepts/operations <span style="color: red;"> (?)</span>:
- Filter
- Mask - <span style="color: red;">Using clouds as an example</span> 
- Clip
- Map
- Iterate
- Reduce - <span style="color: red;">Mention how scale is important</span> 
- Joins <span style="color: red;"> (?)</span>


<!--
If time, could also show:
- Aggregation taking into account cloud cover (ie, avoiding areas with clouds when aggregating)
But at least should mention that often need to consider cloud cover when aggregating
- Raster math - maybe make NDVI out of landsat and add NDVI as a band? But may be too much.
Also NDVI is often precomputed within GEE.

But can see how long things end up being. Staying more basic and just showing
how to aggregate, clip and export imagery during this session would be super good.
-->

---

class: inverse, center, middle
name: js

# Export data

---

# Export data

 - Export GeoTIFF
 - Export CSVs

---
class: inverse, center, middle
name: references

# References and useful resources


<!--
# [RM]
We can think more about whether something like this would be useful (we briefly)
discussed when we met). But we can think about making some sort of collection
of useful scripts, and go over these at the end. Maybe worth us thinking about
what scripts would be most useful - but could do scripts for:
- Downloading monthly VIIRS
- Downloading annual VIIRS
- Downloading annual DMSP-OLS
- Downloading NDVI from landsat
- Downloading NDVI from MODIS
- Downloading weather data (precipitation / temperature)

So kinda the goal of this training will be to:
1. Teach people about GEE, so they can do basic stuff on their own
2. Advertise existing resources, so with this training people should at least
be comfortable using some pre-packaged scripts that we create

Here's a super unorganized collection of a bunch of scripts I've made, but we
can create a separate github repo or something, or thing about some way to
share some resouces: https://code.earthengine.google.com/?accept_repo=users/robmarty3/ieConnectGEE

Maybe one thing to think about is creating a set of functions for aggregating/clipping
VIIRS/DMSP/NDVI for a country, then seeing if there's a way to source these functions
into GEE from a github repo.
-->


---

# References and useful resources

 - [GEE Beginner's Cookbook](https://developers.google.com/earth-engine/tutorials/community/beginners-cookbook)
 - [Introduction to JavaScript for Earth Engine](https://developers.google.com/earth-engine/tutorials/tutorial_js_01)
 - https://courses.spatialthoughts.com/end-to-end-gee.html
 - https://developers.google.com/earth-engine/guides/best_practices

---

# Thank you!


&lt;img src="img/werner_projection.jpg" width="500px" style="display: block; margin: auto;" /&gt;


.footnote[*[Werner projection](https://en.wikipedia.org/wiki/Werner_projection)]

---

<!-- ---

class: inverse, center, middle
name: appendix

# Appendix -->


    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create();
    </script>
  </body>
</html>
